<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body><h1>通用 App SDK</h1>
<h2>请求接口数据方法</h2>
<h3>TYSdk.apiRequest()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>请求API接口
 * <span class="hljs-doctag">@param <span class="hljs-type">{Object}</span> </span>- 请求参数
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> </span>- 成功回调
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> </span>- 失败回调
 */</span>

TYSdk.apiRequest(
  {
    <span class="hljs-attr">a</span>: apiName,
    <span class="hljs-attr">v</span>: apiVersion
    <span class="hljs-attr">postData</span>: params,
  }
 )
  .then(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
     <span class="hljs-built_in">console</span>.log(data);
  })
  .catch(<span class="hljs-function"><span class="hljs-params">error</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(error);
  });
</code></div></pre>
<h2>Event 方法</h2>
<h3>监听方法</h3>
<pre><div class="hljs"><code class="language-javascript"><span class="hljs-keyword">import</span> { TYSdk } <span class="hljs-keyword">from</span> <span class="hljs-string">"tuya-panel-kit"</span>;

<span class="hljs-keyword">const</span> TYEvent = TYSdk.event;

<span class="hljs-comment">/**
 * @param {String} yourEventName - 事件名
 * @param {Function} yourHandler - 监听成功触发的回调
 */</span>
TYEvent.on(yourEventName, yourHandler); <span class="hljs-comment">// 开始监听事件</span>

TYEvent.off(yourEventName, yourHandler); <span class="hljs-comment">// 取消监听事件</span>

TYEvent.emit(yourEventName, yourHandler); <span class="hljs-comment">// 主动触发事件</span>
</code></div></pre>
<h3>常用事件名</h3>
<ul>
<li><strong><code>deviceDataChange</code></strong>：核心事件，该事件总共分为三块。通过返回值中的 <code>type</code> 字段区分：
<ul>
<li><code>dpData</code> ：DP 点状态变更，例如设备 DP 点状态变更。</li>
<li><code>devInfo</code> ：设备信息变更，例如设备名称变更。</li>
<li><code>deviceOnline</code> ：设备在线状态变更。</li>
</ul>
</li>
<li><strong><code>networkStateChange</code></strong>：App 网络状态变更通知。</li>
<li><strong><code>bluetoothChange</code></strong>：蓝牙在线状态变更通知。</li>
<li><strong><code>linkageTimeUpdate</code></strong>：定时状态变更通知。</li>
<li><strong><code>NAVIGATOR_ON_WILL_FOCUS</code></strong>： NavigatorLayout 内部封装的路由变更事件，每次页面进行切换之前调用。</li>
<li><strong><code>NAVIGATOR_ON_DID_FOCUS</code></strong>： NavigatorLayout 内部封装的路由变更事件，每次页面切换完成或者初始化之后进行调用。</li>
</ul>
<blockquote>
<p><strong>注意</strong>：在执行 <code>componentWillUnmount</code> 时，取消监听事件。</p>
</blockquote>
<h2>Device 方法</h2>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> { TYSdk } <span class="hljs-keyword">from</span> <span class="hljs-string">"tuya-panel-kit"</span>;

<span class="hljs-keyword">const</span> TYDevice = TYSdk.device;
</code></div></pre>
<h3>TYDevice.putDeviceData()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>下发 dp 点(与硬件端交互核心方法)
 * <span class="hljs-doctag">@param <span class="hljs-type">{Object}</span> <span class="hljs-variable">data</span></span> - dp点数据
 */</span>

TYDevice.putDeviceData(data);
</code></div></pre>
<h3>TYDevice.getDpCodeById()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>根据 dpId 获取 dpCode
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">dpId</span></span>
 * <span class="hljs-doctag">@returns <span class="hljs-type">{String}</span> <span class="hljs-variable">dpCode</span></span>
 */</span>

TYDevice.getDpCodeById(dpId);
</code></div></pre>
<h3>TYDevice.getDpIdByCode()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>根据 dpCode 获取 dpId
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">dpCode</span></span>
 * returns {Number|String} dpId
 */</span>
TYDevice.getDpIdByCode(dpCode);
</code></div></pre>
<h3>TYDevice.isMeshDevice()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>是否是组网设备
 * returns {Boolean}
 */</span>

TYDevice.isMeshDevice();
</code></div></pre>
<h3>TYDevice.isMeshWifiDevice()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>是否是无线组网设备
 * returns {Boolean}
 */</span>

TYDevice.isMeshWifiDevice();
</code></div></pre>
<h3>TYDevice.isWifiDevice()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>是否是无线 Wi-Fi 设备
 * returns {Boolean}
 */</span>

TYDevice.isMeshWifiDevice();
</code></div></pre>
<h2>Native 方法</h2>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-keyword">import</span> { TYSdk } <span class="hljs-keyword">from</span> <span class="hljs-string">"tuya-panel-kit"</span>;

<span class="hljs-keyword">const</span> TYNative = TYSdk.native;
</code></div></pre>
<h3>TYNative.gotoDpAlarm()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>跳转到云定时页面
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">category</span></span> - 定时类型
 * <span class="hljs-doctag">@param <span class="hljs-type">{String | Number}</span> <span class="hljs-variable">dpId</span></span> - 获取定时的 dp 点
 * <span class="hljs-doctag">@param <span class="hljs-type">{String }</span> <span class="hljs-variable">dpName</span></span> - dp 点显示的名字
 * <span class="hljs-doctag">@param <span class="hljs-type">{Array}</span> <span class="hljs-variable">rangeKeys</span></span> - dp 点的值范围
 * <span class="hljs-doctag">@param <span class="hljs-type">{ Array }</span> <span class="hljs-variable">rangeValues</span></span> - dp 点的显示数据范围(rangeKeys 对应的文本信息)
 */</span>

<span class="hljs-keyword">const</span> dpId = TYDevice.getDpIdByCode(dpCode);
<span class="hljs-keyword">const</span> dpName = Strings.getDpLang(dpCode);
<span class="hljs-keyword">const</span> category = <span class="hljs-string">"Dp_Spray"</span>;
TYNative.gotoDpAlarm({
  category,
  <span class="hljs-attr">repeat</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 0代表需要选择重复、1代表不需要</span>
  <span class="hljs-attr">data</span>: [
    {
      dpId,
      dpName,
      <span class="hljs-attr">selected</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// dp点默认值的index</span>
      <span class="hljs-attr">rangeKeys</span>: [<span class="hljs-literal">true</span>, <span class="hljs-literal">false</span>],
      <span class="hljs-attr">rangeValues</span>: [dpValue1, dpValue2],
    },
  ],
});
</code></div></pre>
<div align="center"><img src="https://images.tuyacn.com/fe-static/docs/img/bdfd0d35-5e2f-46e2-931a-cc1bcf0f6a8e.jpeg" width="50%" height="50%"><img src="https://images.tuyacn.com/fe-static/docs/img/6c74e552-a631-40aa-b187-6551689b03f5.jpeg" width="50%" height="50%"></div>
<h3>TYNative.showPromptDialog()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>轻量级对话
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">confirmText</span></span> - 确认文本
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">cancelText</span></span> - 取消文本
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">title</span></span> - 对话框标题
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">message</span></span> - 文本
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">defaultValue</span></span> - 默认值
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onConfirmed</span></span> - 确认函数
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onCanceled</span></span> - 取消函数
 */</span>

TYNative.showPromptDialog(
  confirmText,
  cancelText,
  title,
  message,
  defaultValue,
  onConfirmed,
  onCanceled
);
</code></div></pre>
<h3>TYNative.showEditDialog()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>编辑对话框
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">title</span></span> - 标题
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">editString</span></span> - 编辑信息内容
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onConfirmed</span></span> - 确认函数
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onCanceled</span></span> - 取消函数
 */</span>

TYNative.showEditDialog(title, editString, onConfirmed, onCanceled);
</code></div></pre>
<h3>TYNative.bottomListDialog()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>底部对话列表
 * <span class="hljs-doctag">@param <span class="hljs-type">{Array}</span> <span class="hljs-variable">itemList</span></span> - 列表
 * <span class="hljs-doctag">@param <span class="hljs-type">{Number}</span> <span class="hljs-variable">selected</span></span> - 选中列表的索引
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onConfirmed</span></span> - 确认函数
 */</span>

TYNative.bottomListDialog(itemList, selected, onConfirmed);
</code></div></pre>
<h3>TYNative.simpleConfirmDialog()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>简易确认对话框
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">title</span></span> - 标题
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">msg</span></span> - 对话框信息
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onConfirmed</span></span> - 确认函数
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onCanceled</span></span> - 取消函数
 */</span>

TYNative.simpleConfirmDialog(title, msg, onConfirmed, onCanceled);
</code></div></pre>
<h3>TYNative.simpleTipDialog()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>简易提示框
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">msg</span></span> - 对话框信息
 * <span class="hljs-doctag">@param <span class="hljs-type">{Function}</span> <span class="hljs-variable">onConfirmed</span></span> - 确认函数
 */</span>

TYNative.simpleTipDialog();
</code></div></pre>
<h3>TYNative.showLoading()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>展示读取状态
 * 注意: iOS 系统中，在 modal 的上层显示 dialog，会导致生命周期异常。
 */</span>

TYNative.showLoading();
</code></div></pre>
<h3>TYNative.hideLoading()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>隐藏读取状态
 */</span>

TYNative.hideLoading();
</code></div></pre>
<h3>TYNative.is24Hour()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>是否是24小时制
 * <span class="hljs-doctag">@returns <span class="hljs-type">{Bool}</span></span>
 */</span>

TYNative.is24Hour();
</code></div></pre>
<h3>TYNative.jumpTo()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>跳转到一个没有被取消挂载的已存在场景，可以跳转至网页
 * <span class="hljs-doctag">@param <span class="hljs-type">{String}</span> <span class="hljs-variable">url</span></span> - 设置网页url跳转功能，可跳转商城，官网。若短链已配置参数，则需添加参数，例如 `${url}?homeId=123456`
 */</span>

TYNative.jumpTo(url);
</code></div></pre>
<table style="undefined;table-layout: fixed; width: 805px">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 30%">
</colgroup>
<thead>
  <tr>
    <th>所属模块</th>
    <th>URL</th>
    <th>参数</th>
    <th>备注</th>
  </tr>
</thead>
<tbody>
  <tr>
    <td rowspan="5">场景模块</td>
    <td>ty_add_smart</td>
    <td>无</td>
    <td>添加场景选择类型页面</td>
  </tr>
  <tr>
    <td>smartScene</td>
    <td>无</td>
    <td>跳转到场景首页</td>
  </tr>
  <tr>
    <td>ty_add_scene</td>
    <td>无</td>
    <td>添加普通场景</td>
  </tr>
  <tr>
    <td>ty_add_auto</td>
    <td>无</td>
    <td>添加自动化场景</td>
  </tr>
  <tr>
    <td>ty_goto_siri_shortcut</td>
    <td>无</td>
    <td>管理 Siri 捷径页面</td>
  </tr>
  <tr>
    <td rowspan="8">家庭模块</td>
    <td>tysh_house_manage</td>
    <td>无</td>
    <td>家庭管理页</td>
  </tr>
  <tr>
    <td>tysh_room_manage</td>
    <td>{ "homeId"："房间 id" }</td>
    <td>房间管理页</td>
  </tr>
  <tr>
    <td>tysh_family_add</td>
    <td>无</td>
    <td>添加家庭页</td>
  </tr>
  <tr>
    <td>tysh_family_setting</td>
    <td>{ "homeId"："房间 id" }</td>
    <td>设置家庭页</td>
  </tr>
  <tr>
    <td>tysh_room_setting</td>
    <td>{ "homeId"："房间 id" }</td>
    <td>设置房间页</td>
  </tr>
  <tr>
    <td>tysh_family_add_member</td>
    <td>{ "homeId"："房间 id" }</td>
    <td>添加家庭成员页</td>
  </tr>
  <tr>
    <td>tysh_family_associate_member_rn</td>
    <td>{"memberId"："成员 id"，"isAdmin"："是否是管理员"}</td>
    <td>跳转关联成员页面</td>
  </tr>
  <tr>
    <td>member_info</td>
    <td>{"memberId"："memberId"，"role":"roleType"，"homeId"："homeId"}</td>
    <td>家庭成员信息</td>
  </tr>
  <tr>
    <td rowspan="7">用户中心</td>
    <td>about</td>
    <td>无</td>
    <td>关于我们</td>
  </tr>
  <tr>
    <td>user</td>
    <td>无</td>
    <td>个人信息页</td>
  </tr>
  <tr>
    <td>ty_user_center</td>
    <td>无</td>
    <td>用户中心页</td>
  </tr>
  <tr>
    <td>ty_user_setting</td>
    <td>无</td>
    <td>设置页</td>
  </tr>
  <tr>
    <td>browser</td>
    <td>{ "url"："常见问题网页 url" }</td>
    <td>常见问题</td>
  </tr>
  <tr>
    <td>settingMoreService</td>
    <td>无</td>
    <td>跳转更多服务</td>
  </tr>
  <tr>
    <td>ty_mobile_bind</td>
    <td>无</td>
    <td>手机号绑定</td>
  </tr>
  <tr>
    <td rowspan="7">登录模块</td>
    <td>registernew</td>
    <td>无</td>
    <td>注册新账号</td>
  </tr>
  <tr>
    <td>tp_login</td>
    <td>无</td>
    <td>登录页</td>
  </tr>
  <tr>
    <td>ty_auth_code_login</td>
    <td>{"countryCode"："国家码"，"account"："账号"}</td>
    <td>验证码登录页</td>
  </tr>
  <tr>
    <td>modifyPassword</td>
    <td>无</td>
    <td>登录状态下修改密码</td>
  </tr>
  <tr>
    <td>ty_forget_password</td>
    <td>{"countryCode"："国家码"，"account"："账号"}</td>
    <td>忘记密码</td>
  </tr>
  <tr>
    <td>ty_signout</td>
    <td>无</td>
    <td>退出登录</td>
  </tr>
  <tr>
    <td>ty_anonymous_mode</td>
    <td>无</td>
    <td>跳转体验模式</td>
  </tr>
  <tr>
    <td rowspan="8">配网模块</td>
    <td>device_net_conn_multi_ver</td>
    <td>无</td>
    <td>二维码扫码配网</td>
  </tr>
  <tr>
    <td>device_net_conn</td>
    <td>无</td>
    <td>扫码 OEM 配网</td>
  </tr>
  <tr>
    <td>smartCategory</td>
    <td>无</td>
    <td>设备列表页</td>
  </tr>
  <tr>
    <td>category</td>
    <td>无</td>
    <td>设备列表页</td>
  </tr>
  <tr>
    <td>presentGatewayCategroy</td>
    <td>无</td>
    <td>433 网关子设备列表</td>
  </tr>
  <tr>
    <td>config_device</td>
    <td>{"pid"："产品 Id"}</td>
    <td>特定产品的子设备配网</td>
  </tr>
  <tr>
    <td>device_only_search_config_gw_sub</td>
    <td>{"gwid"："xxxxxxx"}</td>
    <td>网关配子设备</td>
  </tr>
  <tr>
    <td>device_gw_sub_device_help_list</td>
    <td>{"gwid"："xxxxxxx"}</td>
    <td>网关配子设备帮助信息列表</td>
  </tr>
  <tr>
    <td>首页模块</td>
    <td>ty_family_speech</td>
    <td>无</td>
    <td>语音助手桌面快捷方式短链</td>
  </tr>
  <tr>
    <td rowspan="2">反馈模块</td>
    <td>ty_feedback</td>
    <td>{ "key" : "反馈信息 key" }</td>
    <td>填写反馈页</td>
  </tr>
  <tr>
    <td>helpAndFeedBack</td>
    <td>无</td>
    <td>反馈列表页</td>
  </tr>
  <tr>
    <td>消息中心</td>
    <td>messageCenter</td>
    <td>无</td>
    <td>消息中心页</td>
  </tr>
</tbody>
</table>
<h3>TYNative.back()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>跳回之前的路由
 */</span>

TYNative.back();
</code></div></pre>
<h3>TYNative.disablePopGesture()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>iOS 禁用手势全屏返回
 */</span>

TYNative.disablePopGesture();
</code></div></pre>
<h3>TYNative.enablePopGesture()</h3>
<pre><div class="hljs"><code class="language-jsx"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@desc </span>iOS开启手势全屏返回
 */</span>

TYNative.enablePopGesture();
</code></div></pre>
</body></html>